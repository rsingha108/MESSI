TOPO : 



	20.0.0.2		  20.0.0.1   1.1.1.1				1.1.1.2	  10.0.0.1				10.0.0.2
   d3--------------------------s1------------------------------s2---------------------------d1
																| 2.2.2.2
																|
																|
																|
																|
																|
																|
																|
																|
																| 2.2.2.1
																s3
																| 30.0.0.1
																|
																|
																|
																|
																| 30.0.0.2
																d2
            								



=========================================================================================================

Local Preference : Suppose there are multiple routers (r1,r2,r3) though which we can exit an AS. and suppose for a particular network 50.0.0.0; r1,r2,r3 receives advertisements. Now if we set the local preference of r2 higher, then all other routers within the same AS will get notified about it and they will prefer the path through r2 to reach 50.0.0.0. So, basically if there are multiple exit points, then LP tells us which exit point to choose.

*** To set local preference (normally) : 

s3# conf t
s3(config)# router bgp 500
s3(config-router)# bgp default local-preference 400
s3(config-router)# do clear ip bgp * soft
s3(config-router)# end
s3# exit


*** Using Route map : 

suppose both s1 & s3 advertise 50.0.0.0

In general s2 chooses 1.1.1.1 (s1) for the network 50.0.0.0 (maybe due to low router id)

we want to increase local preference of 2.2.2.1 to 254 so that s2 chooses 2.2.2.1 for the network 50.0.0.0

s2# conf t
s2(config)# access-list 14 permit 50.0.0.0 //(access list 14 matches 50.0.0.0)
s2(config)# route-map RMP permit 10 //route map RMP declared with seq no 10
s2(config-route-map)# match ip address 14 //if ip matches access list 14 (i.e. 50.0.0.0)
s2(config-route-map)# set local-preference 254 // set LP to 254
s2(config-route-map)# exit
s2(config)# route-map RMP permit 20 // otherwise don't do anything
s2(config-route-map)# end
s2# conf t
s2(config)# router bgp 500
s2(config-router)# neighbor 2.2.2.1 route-map RMP in // applied RMP for 2.2.2.1 neighbor for incoming routes
s2(config-router)# end
s2# clear ip bgp * soft
s2# show ip bgp

...
*>i50.0.0.0         2.2.2.1                  0    254      0 i
* i                 1.1.1.1                  0    100      0 i

