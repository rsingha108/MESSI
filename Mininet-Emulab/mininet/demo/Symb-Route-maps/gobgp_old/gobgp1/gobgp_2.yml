global:
  config:
    as: 42000

neighbors:
  - config:
      neighbor-address: 10.1.1.1
      peer-as: 42001
      transport:
        config:
          local-address: "10.1.1.2"
      apply-policy:
        config:
          export-policy-list: ["R1-Out"]
  - config:
      neighbor-address: "192.168.1.1"
      peer-as: 42000
      transport:
        config:
          local-address: "192.168.1.2"
      apply-policy:
        config:
          import-policy-list: ["R2-In"]

defined-sets:
  community:
    community-list:
      - name: "R2-In-Community"
        members: ["100:2"]

policy-definitions:
  - policy-definition:
      name: "R1-Out"
      statements:
        - statement:
            name: "add-community"
            conditions:
              match:
                prefix-set: "R1-network"
            actions:
              bgp-actions:
                set-community: ["100:1"]
        - statement:
            name: "accept-all"
            actions:
              accept-route: {}
  - policy-definition:
      name: "R2-In"
      statements:
        - statement:
            name: "accept-R2-In-Community"
            conditions:
              match:
                bgp-conditions:
                  match-community: ["R2-In-Community"]
            actions:
              accept-route: {}

